![License](https://img.shields.io/badge/license-sushiware-red)
![Issues open](https://img.shields.io/github/issues/crashbrz/trufflehog-searcher)
![GitHub pull requests](https://img.shields.io/github/issues-pr-raw/crashbrz/trufflehog-searcher)
![GitHub closed issues](https://img.shields.io/github/issues-closed-raw/crashbrz/trufflehog-searcher)
![GitHub last commit](https://img.shields.io/github/last-commit/crashbrz/trufflehog-searcher)

# TruffleHog Searcher

A powerful, multithreaded command-line tool for searching through JSON files generated by the TruffleHog tool. 
This tool is specifically designed to search inside JSON files created by TruffleHog when using the `--json` output flag. 
It allows case-insensitive searches across specified fields or entire JSON documents, leveraging goroutines for parallel processing.

## Features

- **Case-Insensitive Search**: Easily find matches regardless of case.
- **Field-Specific Search**: Target specific fields in your JSON structure.
- **Multithreaded Processing**: Use the `-t` flag to enable parallel file processing.
- **Search Modes**:
  - `contains`: Match substrings.
  - `exact`: Match full strings.
- **Field List**: Quickly see all searchable fields with the `-l` flag.

## Installation

1. Clone the repository:
   ```bash
   git clone <repository_url>
   cd <repository_directory>
   ```
2. Build the tool:
   ```bash
   go build -o trufflehog-searcher .
   ```

## Usage

### Command-Line Flags

| Flag           | Description                                                                                     | Default Value |
|----------------|-------------------------------------------------------------------------------------------------|---------------|
| `-i`          | Input directory containing JSON files (required).                                                | None          |
| `-s`          | String to search for (required).                                                                | None          |
| `-m`          | Search mode: `contains` or `exact`.                                                             | `contains`    |
| `-f`          | Specific field to search in (optional).                                                         | None          |
| `-l`          | List all searchable fields (case-sensitive).                                                    | None          |
| `-t`          | Number of goroutines for parallel file processing.                                               | `1`           |

### Examples

#### 1. Search Entire JSON Files

Search for all occurrences of the substring `example` in all JSON files within a directory:
```bash
./trufflehog-searcher -i /path/to/json/files -s example
```

#### 2. Field-Specific Search

Search for the substring `value` only within the `file` field:
```bash
./trufflehog-searcher -i /path/to/json/files -s value -f file
```

#### 3. Exact Match Search

Search for the exact string `ExampleValue` in the entire JSON files:
```bash
./trufflehog-searcher -i /path/to/json/files -s ExampleValue -m exact
```

#### 4. Parallel Processing

Use 4 goroutines for faster file processing:
```bash
./trufflehog-searcher -i /path/to/json/files -s example -t 4
```

#### 5. List Searchable Fields

View all available fields that can be targeted with the `-f` flag:
```bash
./trufflehog-searcher -l
```

Example Output:
```
Searchable Fields (case-sensitive):
----------------------------------------
- DecoderName
- DetectorDescription
- DetectorName
- DetectorType
- project
- rotation_guide
- Raw
- RawV2
- Redacted
- SourceID
- commit
- email
- file
- line
- link
- repository
- timestamp
- SourceName
- SourceType
- StructuredData
- VerificationFromCache
- Verified
----------------------------------------
```

## Notes

- All searches are case-insensitive.
- Fields specified with `-f` are case-sensitive.
- Ensure your JSON files are created by TruffleHog (When using the `--json` output flag.)

## License

This project is licensed under the SushiWare license. For more information, check [docs/license.txt](docs/license.txt).
